project_name: "what-1_morphology_classification"
project_save_dir: "./experiments"
training: true
accelerator: "gpu"
dataloader: "mmap"
checkpoint: ""
resume_training: false

data_options:
  data_path: 
  - "/home/dragonlol1/data/mmap_data/22670"
  - "/home/dragonlol1/data/mmap_data/22671"
  - "/home/dragonlol1/data/mmap_data/22672"
  val_split: 0.2
  split_seed: 42
  use_summary_stats: true

model_options:
  in_channels: 9
  num_patches: 128
  token_dim: 256
  num_layers: 8
  num_heads: 4
  hidden_dim: 512
  dropout: 0.1
  drop_path_rate: 0.1
  downstream_task: "morphology_classification"
  loss_fn: "cross_entropy"
  loss_kwargs:
    # sqrt-scaled inverse frequency weights for imbalanced classes
    # 0: cascade (7.86%), 1: starting (23.27%), 2: throughgoing (27.67%),
    # 3: stopping (30.69%), 4: uncontained (10.33%), 5: bundle (0.18%)
    class_weights: [1.98, 1.15, 1.05, 1.00, 1.72, 13.06]
  k_neighbors: 8

training_options:
  batch_size: 256
  lr: 0.0001
  T_max: 30
  weight_decay: 0.01
  epochs: 30
  save_epochs: 10
  num_workers: 8
  precision: "bf16"
  grad_clip: 1.0
