project_name: "neptune_morph_micro"
project_save_dir: "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/pweigel/MEOWS_ML/src/neptune/projects"
training: true
accelerator: "gpu"
num_devices: 1
dataloader: "icecube_parquet"
checkpoint: "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/pweigel/MEOWS_ML/src/neptune/projects/neptune_morph_micro/4nt3dn33/checkpoints/intermediate_model.ckpt"
resume_training: true

data_options:
  train_data_files:
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/pweigel/MC/pointcloud_mc/meows_v4_sig_bkg_training"
  train_data_file_ranges:
    - [0, 99]
  valid_data_files:
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/pweigel/MC/pointcloud_mc/meows_v4_sig_bkg_testing"
  valid_data_file_ranges:
    - [0, 14]
  use_pulse_series: false
  use_latent_representation: false
  shuffle_files: false
  use_morphology_hack: true

model_options:
  in_channels: 9
  num_patches: 64
  token_dim: 128
  mlp_layers: [128, 256, 512]
  num_layers: 6
  num_heads: 4
  hidden_dim: 128
  dropout: 0.1
  downstream_task: "morphology_classification"
  num_classes: 5
  loss_fn: "cross_entropy"
  k_neighbors: 6
  pool_method: "max"
  pre_norm: true

training_options:
  batch_size: 512
  lr: 0.0001
  lr_schedule: [0, 15]
  weight_decay: 0.01
  epochs: 15
  save_epochs: 1
  num_workers: 16
  precision: "bf16-mixed"
  test_precision: "32-true"